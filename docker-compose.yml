version: '3.8'

services:
  reddit-mcp:
    image: reddit-mcp-server:latest  # You'll need to build/provide this image
    ports:
      - "5000:5000"
    environment:
      - REDDIT_USER_AGENT=ThreadsInfluencerAgent/1.0
    networks:
      - influencer-network

  threads-agent:
    build:
      context: .
      dockerfile: Dockerfile
    depends_on:
      - reddit-mcp
    environment:
      REDDIT_MCP_URL: http://reddit-mcp:5000
      THREADS_API_KEY: ${THREADS_API_KEY}
      THREADS_ACCESS_TOKEN: ${THREADS_ACCESS_TOKEN}
      CLAUDE_API_KEY: ${CLAUDE_API_KEY}
      POSTING_SCHEDULE_HOUR_1: ${POSTING_SCHEDULE_HOUR_1:-8}
      POSTING_SCHEDULE_HOUR_2: ${POSTING_SCHEDULE_HOUR_2:-18}
      FOLLOW_USERS_PER_DAY: ${FOLLOW_USERS_PER_DAY:-3}
      LIKE_POSTS_PER_DAY: ${LIKE_POSTS_PER_DAY:-5}
      MAX_CONTENT_AGE_DAYS: ${MAX_CONTENT_AGE_DAYS:-3}
      POST_CONTENT_THEME: ${POST_CONTENT_THEME:-i work with fools}
      LOG_LEVEL: ${LOG_LEVEL:-info}
    networks:
      - influencer-network
    restart: unless-stopped

networks:
  influencer-network:
    driver: bridge
